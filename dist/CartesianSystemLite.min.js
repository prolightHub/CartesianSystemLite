!function n(r,o,h){function c(t,e){if(!o[t]){if(!r[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(d)return d(t,!0);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}var a=o[t]={exports:{}};r[t][0].call(a.exports,function(e){return c(r[t][1][e]||e)},a,a.exports,n,r,o,h)}return o[t].exports}for(var d="function"==typeof require&&require,e=0;e<h.length;e++)c(h[e]);return c}({1:[function(i,s,e){(function(e){var a=i("cartesian-system-lite/src/level"),n={Tweens:i("./tweens"),Camera:i("./camera"),GameObjects:{GameObject:i("./gameobjects/gameobject.js"),Rect:i("./gameobjects/rect.js"),Circle:i("./gameobjects/circle.js")}},r=n;for(var t in(n=function(e){e.level=e.level||{},e.camera=e.camera||{},e.cameraGrid=e.cameraGrid||{},a.apply(this,arguments),this.level.setSize(e.level.x||0,e.level.y||0,e.level.width||e.camera.width||0,e.level.height||e.camera.height||0),this.camera=new r.Camera(e.camera.x||0,e.camera.y||0,e.camera.width,e.camera.height),this.camera.imports={level:this.level};var t=n.prototype.cameraGrid,i=e.cameraGrid.cellWidth||100,s=e.cameraGrid.cellHeight||100;t.useCellCache=e.cameraGrid.useCellCache||!1,t.setup(Math.floor(this.level.width/i),Math.floor(this.level.height/s),i,s),n.prototype.gameObjects.imports={camera:this.camera}}).prototype={associativeArray:i("./associativearray"),gameObjects:i("./gameobjects/index.js"),cameraGrid:i("./cameragrid"),factory:i("./factory")},r)n[t]=r[t];s.exports=n,e.CartesianSystemLite=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./associativearray":2,"./camera":3,"./cameragrid":4,"./factory":5,"./gameobjects/circle.js":6,"./gameobjects/gameobject.js":7,"./gameobjects/index.js":8,"./gameobjects/rect.js":9,"./tweens":11,"cartesian-system-lite/src/level":10}],2:[function(e,t,i){var r=e("../tweens/index.js");t.exports=function(i,e,t){"object"!=typeof e&&(e={});var s=t||r.String.lower(i.name),a={references:{},temp:{lowest:void 0,highest:0},_name:s,Object:i,add:function(){var e=this.temp.highest+1;if(void 0===this.temp.lowest||this.unique||(e=this.temp.lowest,this.temp.lowest=void 0),e>this.temp.highest&&(this.temp.highest=e),void 0!==i.apply){var t=Object.create(i.prototype);i.apply(t,arguments),this[e]=t}else this[e]=arguments[0];t=this[e];return Object.defineProperties(t,{_name:{enumerable:!1,writable:!0,configurable:!0,value:this.temp.name||s},_arrayName:{enumerable:!1,writable:!0,configurable:!0,value:this._name},_id:{enumerable:!1,writable:!0,configurable:!0,value:e}}),delete this.temp.name,t},remove:function(e){return e===this.temp.highest&&this.temp.highest--,(void 0===this.temp.lowest||e<this.temp.lowest)&&(this.temp.lowest=e),delete this[e]},addObject:function(e){if(void 0===this.references[e]){var t=Array.prototype.slice.call(arguments);this.temp.name=t.shift();var i=this.add.apply(this,t);return this.references[e]=i._id,i}},getObject:function(e){return this[this.references[e]]},removeObject:function(e){delete this[this.references[e]],delete this.references[e]},forEach:function(e){for(var t in this)e(this[t],t,this)}};for(var n in a)Object.defineProperty(e,n,{enumerable:!1,writable:!0,configurable:!0,value:a[n]});return e}},{"../tweens/index.js":11}],3:[function(e,t,i){function s(e,t,i,s){n.call(this,e,t,i,s),this.focusX=this.halfWidth,this.focusY=this.halfHeight,this.speed=1,this.padding=0;var a=this;this.body.updateBoundingBox=function(){this.boundingBox.minX=a.focusX-a.halfWidth,this.boundingBox.minY=a.focusY-a.halfHeight,this.boundingBox.maxX=a.focusX+a.halfWidth,this.boundingBox.maxY=a.focusY+a.halfHeight},this.body.updateBoundingBox()}var n=e("../gameobjects/rect.js"),a=e("../tweens/index.js"),r=e("../cameragrid/index.js");s.prototype.follow=function(e,t){this.angle=Math.atan2(t-this.focusY,e-this.focusX),this.distance=Math.sqrt(Math.pow(e-this.focusX,2)+Math.pow(t-this.focusY,2))*this.speed,this.focusX+=this.distance*Math.cos(this.angle),this.focusY+=this.distance*Math.sin(this.angle);var i=this.imports.level;this.focusX=a.Math.constrain(this.focusX,i.bounds.minX+this.halfWidth,i.bounds.maxX-this.halfWidth),this.focusY=a.Math.constrain(this.focusY,i.bounds.minY+this.halfHeight,i.bounds.maxY-this.halfHeight),this._upperLeft=r.getPlace(this.focusX-this.halfWidth-r.cellWidth*this.padding,this.focusY-this.halfHeight-r.cellHeight*this.padding),this._lowerRight=r.getPlace(this.focusX+this.halfWidth+r.cellWidth*this.padding,this.focusY+this.halfHeight+r.cellHeight*this.padding),this.body.updateBoundingBox()},s.prototype.translate=function(e){e(this.x,this.y);var t=this.imports.level;t.bounds.maxX-t.bounds.minX>=this.width?e(this.halfWidth-this.focusX,0):e(-t.bounds.minX,0),t.bounds.maxY-t.bounds.minY>=this.height?e(0,this.halfHeight-this.focusY):e(0,-t.bounds.minY)},s.prototype.view=function(e,t){if("object"==typeof e){var i=e.body.boundingBox,s=i.minX+(i.maxX-i.minX)/2,a=i.minY+(i.maxY-i.minY)/2;this.follow(s,a)}else this.follow(e,t),t=arguments[2];t&&this.translate(t)},t.exports=s},{"../cameragrid/index.js":4,"../gameobjects/rect.js":9,"../tweens/index.js":11}],4:[function(e,t,i){var s=[];s.setup=function(e,t,i,s){this.cellWidth=i,this.cellHeight=s,this.halfCellWidth=i/2,this.halfCellHeight=s/2,this.setSize(e,t)},s.setSize=function(e,t){for(var i=this.length=0;i<e;i++){this.push([]);for(var s=0;s<t;s++)this[i].push({}),this.useCellCache&&Object.defineProperty(this[i][s],"cache",{writable:!0,enumerable:!1,value:{}})}this.cols=e,this.rows=t,this.maxCol=this.length-1,this.maxRow=this[0].length-1,this.minCol=0,this.minRow=0},s.getPlace=function(e,t){return{col:Math.max(Math.min(Math.round((e-this.halfCellWidth)/this.cellWidth),this.maxCol),this.minCol),row:Math.max(Math.min(Math.round((t-this.halfCellHeight)/this.cellHeight),this.maxRow),this.minRow)}},s.addReference=function(e){for(var t=e._arrayName+e._id,i={arrayName:e._arrayName,id:e._id},s=this.getPlace(e.body.boundingBox.minX,e.body.boundingBox.minY),a=this.getPlace(e.body.boundingBox.maxX,e.body.boundingBox.maxY),n=s.col;n<=a.col;n++)for(var r=s.row;r<=a.row;r++)this[n][r][t]=i;e._upperLeft=s,e._lowerRight=a},s.removeReference=function(e){for(var t=e._arrayName+e._id,i=e._upperLeft,s=e._lowerRight,a=i.col;a<=s.col;a++)for(var n=i.row;n<=s.row;n++)delete this[a][n][t]},s.setProperties=function(e){Object.defineProperty(e,"_upperLeft",{enumerable:!1,writable:!0,configurable:!0,value:{}}),Object.defineProperty(e,"_lowerRight",{enumerable:!1,writable:!0,configurable:!0,value:{}})},t.exports=s},{}],5:[function(e,t,i){var a=e("../gameobjects/index.js"),n=e("../cameragrid/index.js"),s=e("../associativearray/index.js"),r=e("../tweens/index.js"),o={add:function(){var e=Array.prototype.slice.call(arguments),t=e[0];e.shift();var i=a[a.references[t]],s=i.add.apply(i,e);return n.addReference(s,!0),"function"==typeof s.setup&&s.setup(),s},get:function(e,t){return a[a.references[e]][t]},destroy:function(e,t){var i=a[a.references[e]];return!(!i||!i[t])&&(i[t].destroy(),!0)},addArray:function(){var e,t;return"string"==typeof arguments[0]&&"function"==typeof arguments[1]?(e=arguments[0],t=arguments[1]):"function"==typeof arguments[0]&&(e=r.String.lower(arguments[0].name),t=arguments[0]),a.addObject(e,s(t))},getArray:function(e){return a[a.references[e]]},removeArray:function(e){var t=a[a.references[e]];if(!t)return!1;for(var i in t)t[i].hide();return a.removeObject(e),!0}};t.exports=o},{"../associativearray/index.js":2,"../cameragrid/index.js":4,"../gameobjects/index.js":8,"../tweens/index.js":11}],6:[function(e,t,i){var s=e("./index.js"),a=e("../associativearray/index.js"),n=e("./gameobject.js");function r(e,t,i){n.call(this,arguments),this.x=e,this.y=t,this.diameter=i,this.radius=i/2,this.body.physics.shape="circle";var s=this;this.body.updateBoundingBox=function(){this.boundingBox.minX=s.x-s.radius,this.boundingBox.minY=s.y-s.radius,this.boundingBox.maxX=s.x+s.radius,this.boundingBox.maxY=s.y+s.radius},this.body.updateBoundingBox()}s.addObject("circle",a(r)),t.exports=r},{"../associativearray/index.js":2,"./gameobject.js":7,"./index.js":8}],7:[function(e,t,i){var s=e("./index.js"),a=e("../cameragrid/index.js"),n=e("../associativearray/index.js"),r=e("../tweens/index.js");function o(){this.body={physics:{shape:"",moves:!1},boundingBox:{minX:0,minY:0,maxX:0,maxY:0},updateBoundingBox:r.NOOP},this.update=r.NOOP,this.draw=r.NOOP,this.remove=function(){s[s.references[this._arrayName]].remove(this._id)},this.hide=function(){if(a.removeReference(this),s.used[s.references[name]]){var e=s.used[s.references[name]],t=e.indexOf(this._id);0<=t&&e.splice(t,1)}},this.destroy=function(){this.hide(),this.remove()},a.setProperties(this)}s.addObject("gameObject",n(o)),t.exports=o},{"../associativearray/index.js":2,"../cameragrid/index.js":4,"../tweens/index.js":11,"./index.js":8}],8:[function(e,t,i){var s=e("../associativearray/index.js"),f=e("../cameragrid/index.js"),a=(e("../tweens/index.js").NOOP,s([],void 0,"gameObjects"));a.used={},a.window=function(e,t){var i,s,a,n,r,o,h={};this.used={};var c=(e=e||this.imports.camera)._upperLeft.col,d=e._lowerRight.col,u=e._upperLeft.row,l=e._lowerRight.row;for(t&&("object"==typeof t?(c+=t.left,d+=t.right,u+=t.up,l+=t.down):(c-=t,d+=t,u-=t,l+=t),c=Math.max(c,0),d=Math.min(d,f.maxCol),u=Math.max(u,0),l=Math.min(l,f.maxRow)),i=c;i<=d;i++)for(s=u;s<=l;s++)for(n in a=f[i][s])h[n]||((r=this[this.references[a[n].arrayName]][a[n].id]).body.physics.moves&&(f.removeReference(r),f.addReference(r)),o=this.references[r._arrayName],this.used[o]=this.used[o]||[],this.used[o].push(r._id),h[n]=!0)},a.drawAndUpdate=function(){var e,t;for(e in this.used)for(t=0;t<this.used[e].length;t++)this[e][this.used[e][t]].draw(),this[e][this.used[e][t]].update()},a.draw=function(){var e,t;for(e in this.used)for(t=0;t<this.used[e].length;t++)this[e][this.used[e][t]].draw()},a.update=function(){var e,t;for(e in this.used)for(t=0;t<this.used[e].length;t++)this[e][this.used[e][t]].update()},a.eachObjectsInCamera=function(e){var t,i;for(t in this.used)for(i=0;i<this.used[t].length;i++)e(this[t][this.used[t][i]])},t.exports=a},{"../associativearray/index.js":2,"../cameragrid/index.js":4,"../tweens/index.js":11}],9:[function(e,t,i){var s=e("./index.js"),a=e("../associativearray/index.js"),n=e("./gameobject.js");function r(e,t,i,s){n.call(this,arguments),this.x=e,this.y=t,this.width=i,this.height=s,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.body.physics.shape="rect";var a=this;this.body.updateBoundingBox=function(){this.boundingBox.minX=a.x,this.boundingBox.minY=a.y,this.boundingBox.maxX=a.x+a.width,this.boundingBox.maxY=a.y+a.height},this.body.updateBoundingBox()}s.addObject("rect",a(r)),t.exports=r},{"../associativearray/index.js":2,"./gameobject.js":7,"./index.js":8}],10:[function(e,t,i){t.exports=function(){return this.level={bounds:{}},this.level.setSize=function(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s,this.updateBounds()},this.level.updateBounds=function(){this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.width,this.bounds.maxY=this.y+this.height},this.level}},{}],11:[function(e,t,i){var s={String:{upper:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lower:function(e){return e.charAt(0).toLowerCase()+e.slice(1)}},Math:{constrain:function(e,t,i){return Math.min(Math.max(e,t),i)}},Object:{defineHidden:function(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:i})}},Angle:{resolveAngle:function(e){return(e%=360)<0?360-Math.abs(e):e}}};Object.defineProperty(s,"NOOP",{value:function(){},writable:!1}),t.exports=s},{}]},{},[1]);